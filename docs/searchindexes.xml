<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<search>
  
  <entry>
    <title>å¤§è¯paxos</title>
    <url>https://chaleaoch.com/post/%E5%A4%A7%E8%AF%9Dpaxos/</url>
    <categories><category>ç¬”è®°</category>
    </categories>
    <tags>
      <tag>ç†è®ºæ´¾</tag>
    </tags>
    <content type="html"><![CDATA[ä¸€ç¯‡ç¬”è®°. ä¸å¤Ÿä¸¥è°¨.
paxos æ˜¯ä¸€ä¸ªå…±è¯†ç®—æ³•, å¤§ç™½è¯ç†è§£å°±æ˜¯ä¸€ä¸ªç³»ç»Ÿä¸­çš„æ‰€æœ‰èŠ‚ç‚¹, å¯¹ä¸€ä»¶äº‹è¾¾æˆå…±è¯†. è¿™ä»¶äº‹å¯èƒ½æ˜¯ä¸€ä¸ªåŠ¨ä½œ, è­¬å¦‚ +1, ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå€¼ è­¬å¦‚ set key=value
åº”ç”¨åœºæ™¯:
æœ‰ä¸€ç»„çŠ¶æ€æœº, è­¬å¦‚ redis. å¯¹ redis è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œ [+1,-1,+1,-1,+1,-1,+1,-1,+1,-1,+1,-1,...] æˆ‘ä»¬è¦ä¿è¯ redis é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹,æ”¶åˆ°çš„æ¶ˆæ¯çš„é¡ºåºæ˜¯ä¸€è‡´çš„.
å®¹é”™æ¨¡å‹:
éæ‹œå åº­ç½‘ç»œ, ä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰é»‘å®¢æ¶æ„ä¿®æ”¹æ•°æ®. å…è®¸èŠ‚ç‚¹æŸåå’Œç½‘ç»œå»¶è¿Ÿ. paxos ä¸­çš„è§’è‰²:
proposer, æå‡ºææ¡ˆ(ä¸€ä»¶äº‹)çš„äºº. ä¸‹å›¾ä¸­çš„å´å‡¡å’Œæå³°. acceptor, åšå‡ºå†³ç­–çš„äºº, å¾ˆå¤š proposer ä¼šæäº¤å¾ˆå¤šææ¡ˆ, ä½†æ˜¯åªæœ‰ä¸€ä¸ªææ¡ˆä¼šè¢«æ¥å—(åªæœ‰è¿™æ ·æ‰å¯èƒ½è¾¾æˆå…±è¯†). acceptor å°±æ˜¯é‚£ä¸ªåšå‡ºå†³ç­–çš„äºº(ä»¬)., ä¸‹å›¾ä¸­çš„ä¸­é—´ä¸‰ä¸ªäºº,å†¯åˆš,å¼ æŸå’Œé™ˆå“¥. learner, ä¸æå‡ºææ¡ˆ, åªå‚ä¸å­¦ä¹ . ç±»ä¼¼ç²‰ä¸. ä¸‹å›¾æ²¡æœ‰ä½“ç°. æç¤º: åŒä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å…¼ä»»ä¸Šé¢ä¸‰ä¸ªè§’è‰², ä¹Ÿå°±æ˜¯è¯´, ä¸€ä¸ªèŠ‚ç‚¹æ—¢å¯ä»¥æå‡ºææ¡ˆ,ä¹Ÿå¯ä»¥åšå‡ºå†³ç­–.
å¤§è¯ä¸€ä¸ªä¾‹å­: å´å‡¡å’Œæå³°åˆ†åˆ«æå‡ºäº†ææ¡ˆ. æœ€åæ‰€æœ‰äººè¾¾æˆå…±è¯†.
ä¸‹å›¾ä¸­ç»¿è‰²èƒŒæ™¯éƒ¨åˆ†æ˜¯æœ€åè¾¾æˆä¸€è‡´çš„æ—¶é—´ç‚¹.
ä¸‹å›¾åªæ˜¯ä¸€ç§æ¯”è¾ƒå…¸å‹çš„æ—¶åºåœºæ™¯, å®é™…åœºæ™¯è¿œæ¯”ä¸‹å›¾è¦å¤æ‚çš„å¤š. ç²¾åŠ›æœ‰é™æ— æ³•å…¨éƒ¨ç”»å‡º.
æœ€åçš„å­¦ä¹ é˜¶æ®µæ¯”è¾ƒç®€å•. å°±æ˜¯å½“ä¸€è½®å†³ç­–äº§ç”Ÿä¹‹å,learner å‘ accepter å­¦ä¹ ä¸€ä¸‹å°±è¡Œäº†. è¿™é‡Œä¸æ˜¯é‡ç‚¹. ]]></content>
  </entry>
  
  <entry>
    <title>pythonå¯¹å±æ€§çš„æœç´¢ä¼˜å…ˆçº§</title>
    <url>https://chaleaoch.com/post/python%E5%AF%B9%E5%B1%9E%E6%80%A7%E7%9A%84%E6%90%9C%E7%B4%A2%E4%BC%98%E5%85%88%E7%BA%A7/</url>
    <categories><category>default</category>
    </categories>
    <tags>
      <tag>python</tag>
    </tags>
    <content type="html"><![CDATA[å½“è·å–å…ƒç´ çš„æ—¶å€™ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯object.__getattribute__(key) æ‰€è°“çš„æœç´¢ä¼˜å…ˆçº§å®é™…ä¸Šæ˜¯object.__getattribute__(key)å®ç°çš„
Data Descriptor å’Œ Non-data Descriptor çš„ä¸åŒä½“ç°åœ¨å…³äºå®ä¾‹å­—å…¸æ¡ç›®çš„è¦†ç›–å’Œè®¡ç®—é¡ºåºä¸Šã€‚ å¦‚æœå®ä¾‹å­—å…¸ä¸­åŒ…å«äº†ä¸ Data Descriptor åŒåçš„å±æ€§ï¼Œé‚£ä¹ˆ Data Descriptor ä¼˜å…ˆã€‚ å¦‚æœå®ä¾‹å­—å…¸ä¸­åŒ…å«äº†ä¸ Non-data Descriptor åŒåçš„å±æ€§ï¼Œå®ä¾‹å­—å…¸ä¼˜å…ˆã€‚
åŒæ—¶å®šä¹‰get()å’Œset()æ–¹æ³•ï¼Œå¹¶ä¸”set()åœ¨è°ƒç”¨æ—¶æŠ›å‡º AttributeError å¼‚å¸¸ï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåªè¯»çš„ Data Descriptorã€‚ åªéœ€è¦å®šä¹‰ä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸çš„set()æ–¹æ³•å°±è¶³ä»¥è®©è¯¥å¯¹è±¡æˆä¸º Data Descriptorã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 class demo(object):# éæ•°æ®æè¿°ç¬¦ def __init__(self, *args, **kwargs): self.args = args self.kwargs = kwargs def __get__(self, instance, owner): return owner.__dict__[type(self).__name__](instance, *self.args, **self.kwargs) class Descriptor(object): def __get__(self, instance, owner): return &#39;Descriptor&#39; def __set__(self, instance, value): pass class FOO(object): def __getattr__(self, item): return &#39;__getattr__&#39; def __init__(self, *args, **kwargs): pass # attr = Descriptor() demo = demo() # def demo(self): # pass def __del__(self): pass foo = FOO(1, 2, 3) # foo.attr = &#39;instance attr&#39; # FOO.attr = &#39;class attr&#39; # type(foo).__dict__[&#39;attr&#39;].__get__(foo, type(foo)) # FOO.__dict__[&#39;attr&#39;].__get__(None, FOO) print foo.attr print FOO.attr print FOO.__dict__[&#39;demo&#39;] # &lt;function demo at 0x02F67B30&gt; print FOO.demo # &lt;unbound method FOO.demo&gt; print foo.demo # &lt;bound method FOO.demo of &lt;__main__.FOO object at 0x02F69E30&gt;&gt; print FOO.__dict__[&#39;demo&#39;].__get__(None, FOO) == FOO.demo #True print type(foo).__dict__[&#39;demo&#39;].__get__(foo, type(foo)) == foo.demo # #True 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 def __getattribute__(self, key): # selfæ˜¯ä¸€ä¸ªç±» if type(type) == type(self): pass # å’Œå®ä¾‹ç±»ä¼¼ï¼ŒåŒºåˆ«1ï¼Œä½†æ˜¯æ²¡æœ‰__getattr__2ï¼Œé’ˆå¯¹éæ•°æ®æè¿°ç¬¦çš„å¤„ç†æ–¹å¼æ˜¯ä¸åŒçš„ã€‚ï¼ˆunbound methodï¼‰ # selfæ˜¯ä¸€ä¸ªå®ä¾‹ else: # æ•°æ®å‹æè¿°ç¬¦ _attr = type(self).__dict__.get(key) if _attr and hasattr(_attr, &#39;__get__&#39;) and hasattr(_attr, &#39;__set__&#39;): _value = type(self).__dict__[key] if hasattr(_value, &#39;__get__&#39;): return _value.__get__(self, type(self)) return _value del _attr # å®ä¾‹å±æ€§ _attr = self.__dict__.get(key) if _attr: return _attr del _attr # éæ•°æ®æè¿°ç¬¦ _attr = type(self).__dict__.get(key) if _attr and hasattr(_attr, &#39;__get__&#39;): _value = type(self).__dict__[key] if hasattr(_value, &#39;__get__&#39;): return _value.__get__(self, type(self)) return _value del _attr # ç±»å±æ€§ _attr = type(self).__dict__.get(key) if _attr: return _attr # çˆ¶ç±»å±æ€§ for FClass in self.__class__.__mro__: _attr = FClass.__dict__.get(key) if _attr: return _attr # __getattr__ if hasattr(self, &#39;__getattr__&#39;): return self.__getattr__(key) else: raise AttributeError(&#39;type object &#34;{1}&#34; has no attribute &#34;{2}&#34;&#39;.format(str(self.__class__), key)) ]]></content>
  </entry>
  
  <entry>
    <title>goåˆ‡ç‰‡åšä¸ºå‡½æ•°å‚æ•°éœ€è¦çŸ¥é“çš„ä¸€äº›çŸ¥è¯†</title>
    <url>https://chaleaoch.com/post/go%E5%88%87%E7%89%87%E5%81%9A%E4%B8%BA%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E4%BA%9B%E7%9F%A5%E8%AF%86/</url>
    <categories><category>ç¬”è®°</category>
    </categories>
    <tags>
      <tag>golang</tag>
    </tags>
    <content type="html"><![CDATA[åœ¨ go è¯­è¨€ä¸­,æ‰€æœ‰ç±»å‹éƒ½æ˜¯å€¼ä¼ é€’, è¿™ä¸ªçŸ¥è¯†åœ¨å‡ ä¹æ‰€æœ‰ go è¯­æ³•ä¹¦ä¸­éƒ½æœ‰ä»‹ç». ä½†æ˜¯åˆ‡ç‰‡å’Œ map è¿™ä¿©æ•°æ®ç»“æ„åœ¨åšä¸ºå‡½æ•°å‚æ•°çš„æ—¶å€™,å¯ä»¥é€šè¿‡å½¢å‚æ”¹å˜å®å‚. è¿™å’Œå€¼ä¼ é€’ç†å¿µæ˜¯ç›¸èƒŒç¦»çš„.
è¿™é‡Œåšä¸ªå°ç¬”è®°å¢å¼ºè®°å¿†.
slice æ˜¯ä¸€ä¸ªç»“æ„ä½“, å…¶ä¸­æœ‰ä¸€ä¸ªå­—æ®µæ˜¯æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆ ä½†æ˜¯ slice ä¾ç„¶æ˜¯å€¼æ‹·è´. å‚è€ƒä¸‹é¢ä»£ç æ¯”è¾ƒå·®å¼‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 package main import &#34;fmt&#34; func myAppend(s []int) []int { s = append(s, 100) return s } func myAppend2(s []int) { s[0] = 666 } func myAppendPtr(s *[]int) { *s = append(*s, 100) } func main() { s := []int{1, 1, 1} myAppend(s) fmt.Println(s) myAppend2(s) fmt.Println(s) myAppendPtr(&amp;s) fmt.Println(s) } // [1 1 1] // [666 1 1] // [666 1 1 100] ]]></content>
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªä¸å¸¦æ’ä»¶çš„flaskåº”ç”¨2 -- è‡ªå®šä¹‰migrate</title>
    <url>https://chaleaoch.com/post/%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%B8%A6%E6%8F%92%E4%BB%B6%E7%9A%84flask%E5%BA%94%E7%94%A8-copy/</url>
    <categories><category>default</category>
    </categories>
    <tags>
      <tag>flask</tag>
      <tag>python</tag>
    </tags>
    <content type="html"><![CDATA[èµ·å›  å‰æ–‡ ä»‹ç»äº†è‡ªå·±å†™çš„flask-redis å’Œ flask-scheduleræ‰©å±•. ä»Šå¤©ä»‹ç»åŸºäºflask å’Œ peewee å¦‚ä½•å®ç°åŠè‡ªåŠ¨ migrate.
django é»˜è®¤æä¾›äº† migration åŠŸèƒ½. django çš„ migration åŠŸèƒ½åœ¨å¤šäººå¼€å‘çš„æ¨¡å¼ä¸‹ä¼šæœ‰å†²çª,ç»å¸¸éœ€è¦&ndash;merge. å¹¶ä¸”ä¹Ÿä¸èƒ½ä¿è¯å®Œå…¨é¿å…é—®é¢˜. peewee æä¾›äº† migration çš„åŸºç¡€ api æ ‡é¢˜å’Œ å‰æ–‡ æœ‰ä»‹ç», æœ¬é¡¹ç›®å°è¯•é›¶æ’ä»¶å®ç°ä¸€ä¸ª flask åº”ç”¨. åŸºäºä»¥ä¸Š 4 ç‚¹åŸå› , å†³å®šè‡ªå·±å†™ä¸€ä¸ªåŠè‡ªåŠ¨çš„migrateæ’ä»¶. è®©å†²çªå‡ºç°åœ¨git pushé˜¶æ®µ. äººä¸ºåœ¨ä»£ç å±‚é¢è§£å†³å†²çª.è€Œä¸æ˜¯åœ¨make migrateçš„æ—¶å€™æ‰‹å¿™è„šä¹±. peewee çš„ migrate api æä¾›äº†å¸¸è§çš„å¢åˆ æ”¹å­—æ®µå’Œcreate tableåŠŸèƒ½
1 2 3 4 5 6 7 8 9 db.create_tables([table_name]) migrator.add_column(&#39;comment_tbl&#39;, &#39;pub_date&#39;, pubdate_field) migrator.rename_column(&#39;story&#39;, &#39;pub_date&#39;, &#39;publish_date&#39;) migrator.drop_column(&#39;story&#39;, &#39;some_old_field&#39;) migrator.drop_not_null(&#39;story&#39;, &#39;pub_date&#39;) migrator.add_not_null(&#39;story&#39;, &#39;modified_date&#39;) migrator.alter_column_type(&#39;person&#39;, &#39;email&#39;, TextField()) migrator.rename_table(&#39;story&#39;, &#39;stories_tbl&#39;) migrator.add_index(&#39;story&#39;, (&#39;pub_date&#39;,), False) æ›´å¤šå°±ä¸ç²˜äº†. å‚è€ƒ æ–‡æ¡£ å³å¯.
æ€è·¯åŠå®ç° æ€è·¯éå¸¸ç®€å•,åˆ©ç”¨åå°„å’Œpeeweeçš„migrate api, è‡ªå·±å†™ä¸€ä¸ªè¿ç§»çš„class(å°±æ˜¯ä¸‹é¢ä»£ç ä¸­çš„Migrate) æ‰‹åŠ¨æ‰§è¡Œ sql å‘½ä»¤å°±è¡Œäº†. è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯create_tables å¼•å…¥çš„model ä¸èƒ½æ˜¯ä»£ç ä¸­çš„æœ€æ–°ç‰ˆæœ¬çš„model. å¿…é¡»æ˜¯åœ¨åˆšåˆšåˆ›å»ºè¿™ä¸ªmodelæ˜¯çš„ä¸€ä¸ªå¿«ç…§, å®ç°èµ·æ¥ä¹Ÿå¾ˆç®€å•, åšä¸€ä»½æ‹·è´å°±å¯ä»¥äº†. å¦åˆ™, å¦‚æœæŸä¸ªmodelçš„å­—æ®µå‘ç”Ÿäº†å˜åŒ–, createæ–°è¡¨çš„åŒæ—¶åˆaddäº†ä¸€ä¸ªåŒæ ·çš„å­—æ®µä¼šæŠ¥é”™.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 from playhouse.migrate import * def parse_method_name(method_name: str) -&gt; tuple[arrow.arrow.Arrow, int]: migrate_version = 0 method_tuple = method_name.split(&#34;_&#34;) if len(method_tuple) == 2: date = method_tuple[1] elif len(method_tuple) == 3: date = method_tuple[1] migrate_version = method_tuple[2] else: raise Exception(f&#34;Invalid method name: {method_name}&#34;) return arrow.get(date), int(migrate_version) @click.command(&#34;migrate&#34;) @click.argument(&#34;start_version&#34;) @click.argument(&#34;end_version&#34;) @with_appcontext def create_migrations(start_version, end_version): start_version = arrow.get(start_version) end_version = arrow.get(end_version) execute_method_dict = dict[str, arrow.arrow.Arrow | int | Callable] execute_methods: list(execute_method_dict) = [] for method_name, method in inspect.getmembers(Migrate(), predicate=inspect.ismethod): if method_name.startswith(&#34;migrate_&#34;): date, migrate_version = parse_method_name(method_name) if start_version &lt; date and date &lt;= end_version: execute_methods.append( { &#34;date&#34;: date, &#34;migrate_version&#34;: migrate_version, &#34;method&#34;: method, } ) execute_methods.sort(key=lambda x: (x[&#34;date&#34;], x[&#34;migrate_version&#34;])) for execute_method in execute_methods: with flask_db.database.atomic(): try: execute_method[&#34;method&#34;]() except Exception as e: print(f&#34;e:{e},execute_method:{execute_method}&#34;) raise (e) class Migrate: def __init__(self) -&gt; None: self.migrator = PostgresqlMigrator(flask_db.database) self.db = flask_db.database def migrate_20220815(self): self.db.create_tables([AModel,BModel]) def migrate_20220816(self): migrate(self.migrator.add_column(&#34;amodel&#34;, &#34;field_name&#34;, CharField(max_length=255, null=True))) ä½¿ç”¨ flask migrate 20200101 20220101
å®Œ.
]]></content>
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªä¸å¸¦æ’ä»¶çš„flaskåº”ç”¨</title>
    <url>https://chaleaoch.com/post/%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%B8%A6%E6%8F%92%E4%BB%B6%E7%9A%84flask%E5%BA%94%E7%94%A8/</url>
    <categories><category>default</category>
    </categories>
    <tags>
      <tag>flask</tag>
      <tag>python</tag>
    </tags>
    <content type="html"><![CDATA[èµ·å›  äº‹æƒ…çš„èµ·å› æ˜¯è¿™æ ·çš„, æ›¾ç»ç»´æŠ¤è¿‡ä¸€ä¸ªåˆ«äººåšçš„ flask é¡¹ç›®,å¼•ç”¨äº†å¤§é‡çš„æ’ä»¶, åœ¨ç»´æŠ¤è¿‡ç¨‹ä¸­éœ€è¦è°ƒæŸ¥æ’ä»¶çš„æºç æ¥è§£å†³é—®é¢˜, å‘ç°æœ‰çš„æ’ä»¶åŠŸèƒ½å¾ˆå•ä¸€,ä½†æ˜¯å´å†™çš„å¾ˆå¤æ‚(å› ä¸ºå¼€æºæ’ä»¶è¦è€ƒè™‘å„ç§å®é™…ä½¿ç”¨åœºæ™¯). æœ‰æ—¶é—´ç²¾åŠ›è¿˜ä¸å¦‚è‡ªå·±å†™ä¸€ä¸ª. æ°å¥½å¾—åˆ°ä¸€ä¸ªä»é›¶å¼€å§‹çš„é¡¹ç›®. å†³å®šå°è¯•åšä¸€ä¸ªé›¶æ’ä»¶çš„ flask é¡¹ç›®. ç›®å‰æ¥çœ‹æ•ˆæœè¿˜ä¸é”™.
éœ€è¦è¯´æ˜çš„æ˜¯: è¿™é‡Œçš„é›¶æ’ä»¶æ˜¯æŒ‡é›¶ flask æ’ä»¶,ä¸æ˜¯ä¸ç”¨ä»»ä½• python æ’ä»¶.
é¡¹ç›®æ„æˆ ä¸€ä¸ªå¾ˆç®€å•çš„ dashboard, ä¸»è¦ç”¨åˆ°å¦‚ä¸‹ç»„ä»¶
1 2 3 4 5 6 7 8 9 10 11 12 13 14 python = &#34;~3.10&#34; Flask = &#34;~2.1.1&#34; python-dotenv = &#34;~0.20.0&#34; pydantic = &#34;~1.9.0&#34; requests = &#34;~2.27.1&#34; peewee = &#34;~3.14.10&#34; arrow = &#34;~1.2.2&#34; psycopg2 = &#34;~2.9.3&#34; wtf-peewee = &#34;~3.0.4&#34; APScheduler = &#34;~3.9.1&#34; redis = &#34;~4.3.3&#34; SQLAlchemy = &#34;~1.4.37&#34; gunicorn = &#34;~20.1.0&#34; Cython = &#34;^0.29.30&#34; å¯èƒ½ç”¨åˆ°çš„ flask æ’ä»¶æ˜¯: flask-redis, flask-sqlalchemy, flask-peewee, flask-pydantic
flask-redis å…ˆè¯´ flask-redis src/extentions.py
1 2 3 4 5 6 7 8 from redis import Redis class FlaskRedis: def __init__(self) -&gt; None: self.client = None def init(self, app): self.client = Redis.from_url(app.config[&#34;REDIS_URL&#34;]) redis_client = FlaskRedis() åªéœ€è¦åœ¨éœ€è¦çš„åœ°æ–¹
1 2 3 4 from extensions import redis_client def get_redis_data(key) -&gt; list[Any] | dict[Any, Any] | None: ret = redis_client.client.get(f&#34;{key}&#34;) æ˜¯ä¸æ˜¯è¶…çº§ç®€å•,å®Œå…¨æ»¡è¶³é¡¹ç›®éœ€è¦. ä¹Ÿä¸éœ€è¦è®°å¿†å¼€æºæ’ä»¶çš„é…ç½®.
flask apscheduler å†è­¬å¦‚ scheduler src/extentioons.py
1 2 3 4 5 6 7 8 9 10 11 12 from apscheduler.schedulers.blocking import BlockingScheduler class FlaskScheduler: def init(self, app): scheduler = BlockingScheduler() scheduler.configure(**app.config[&#34;SCHEDULER_OPTIONS&#34;]) jobs = app.config.get(&#34;SCHEDULER_JOBS&#34;, []) for job in jobs: scheduler.add_job(**job) self.scheduler = scheduler scheduler = FlaskScheduler() å½“ç„¶,è¿™é‡Œéœ€è¦åœ¨ create_app ä¸­ init ä¸€ä¸‹
1 2 3 4 5 def create_app(test_config: dict[str, Any] = None) -&gt; Flask: ... redis_client.init(app) scheduler.init(app) ... scheduler çš„ä½¿ç”¨éœ€è¦é€šè¿‡ flask ä¸­çš„ click é…åˆå®ç°:
/src/cli/scheduler.py
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 from flask.cli import with_appcontext from extensions import scheduler from flask.cli import AppGroup scheduler_cli = AppGroup(&#34;scheduler&#34;) @scheduler_cli.command(&#34;start&#34;) @with_appcontext def start(): scheduler.scheduler.start() @scheduler_cli.command(&#34;stop&#34;) @with_appcontext def stop(): scheduler.scheduler.stop() æ–‡ç« å†™åˆ°è¿™é‡Œ, å‘ç°è¿™ä¸ªé¡¹ç›®è¿˜æœ‰ä¸€ä¸ªæ›¿æ¢flask-migrateçš„å®ç°. ä½†æ˜¯ç°åœ¨å·²ç»æ˜¯æ—©ä¸Š 8 ç‚¹åŠäº†. æˆ‘è¦å»ä¸Šç­äº†. ç­‰æœ‰æ—¶é—´åœ¨ä¸‹ç¯‡æ–‡ç« ä¸­ä»‹ç».
]]></content>
  </entry>
  
  <entry>
    <title>Hello World</title>
    <url>https://chaleaoch.com/post/hello-world/</url>
    <categories>
    </categories>
    <tags>
    </tags>
    <content type="html"><![CDATA[hello world!
]]></content>
  </entry>
  
  <entry>
    <title>Hello World</title>
    <url>https://chaleaoch.com/posts/hello-world/</url>
    <categories>
    </categories>
    <tags>
    </tags>
    <content type="html"><![CDATA[sdl;fkhasdfhaskldjfhaskldjfhaskldjhfaslkdfjhskldjhdfklajsh
]]></content>
  </entry>
  
  <entry>
    <title>å…³äº Hugo NexT ç»„ç»‡</title>
    <url>https://chaleaoch.com/about.html</url>
    <categories>
    </categories>
    <tags>
    </tags>
    <content type="html"><![CDATA[Hugo NexT ç»„ç»‡æ˜¯ç”±ä¼—å¤šå–œçˆ± NexT ä¸»é¢˜åŠé£æ ¼çš„ä¸–ç•Œå„åœ°å‹äººå…±åŒç»„å»ºè€Œæˆï¼Œä¸ºçš„å°±æ˜¯è®©è¿™ä¸ªä¸»é¢˜ç»§ç»­åœ¨ Hugo å¼•æ“ä¸­ä¹Ÿèƒ½å¾—åˆ°å‘æ‰¬å…‰å¤§ï¼Œåœ¨æ­¤ä¹Ÿæ¬¢è¿ä½ çš„åŠ å…¥ï¼
æˆ‘ä»¬çš„æ„¿æ™¯ å»¶ç»­ NexT ç»å…¸çš„é»‘ç™½è°ƒæ­é…ï¼Œä¿æŒç®€å•çš„æ˜“ç”¨æ€§åŠå¼ºå¤§çš„åŠŸèƒ½ã€‚
ä½¿ç”¨åé¦ˆ åŠ å…¥ GitHub Discussions æˆ– Gitter åœ¨çº¿è®¨è®º ğŸ» GitHub Issues æäº¤é”™è¯¯æŠ¥å‘Š ğŸ› GitHub Feature è¡¨æ–°åŠŸèƒ½çš„æƒ³æ³• âœ¨ åŒæ—¶å›½å†…ç”¨æˆ·ä¹Ÿå¯åŠ å…¥ QQ ç¾¤äº¤æµï¼š 604710815
]]></content>
  </entry>
  
  <entry>
    <title>ç«™ç‚¹ç¤ºä¾‹</title>
    <url>https://chaleaoch.com/flinks.html</url>
    <categories>
    </categories>
    <tags>
    </tags>
    <content type="html"><![CDATA[å¦‚æƒ³è¦äº¤æ¢å‹æƒ…é“¾æ¥ï¼Œè¯·åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç«™ç‚¹ä¿¡æ¯ï¼Œæ ¼å¼å‚è€ƒå¦‚ä¸‹ï¼š
åç§°ï¼š NexT ä¸»é¢˜ è¯´æ˜ï¼š ä¿æŒç®€å•çš„æ˜“ç”¨æ€§å’Œå¼ºå¤§çš„åŠŸèƒ½ã€‚ ç«™æ ‡ï¼š https://hugo-next.eu.org/imgs/hugo_next_avatar.png ç½‘å€ï¼š https://hugo-next.eu.org ]]></content>
  </entry>
  
</search>